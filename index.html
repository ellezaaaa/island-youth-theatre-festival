<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å²›å±¿é’å¹´æˆå‰§èŠ‚ - ä¸“å±è¡Œç¨‹å•</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* ====================
           1. å…¨å±€ä¸åŸºç¡€è®¾ç½®
           ==================== */
        :root {
            --bg-dark: #050505;
            --purple: #7065c1;
            --red: #e31d1a;
            --white: #ffffff;
            --grey: #888888;
            --retro-bg: #f2e6d6;
            --retro-ink: #2b1d1a;
            --retro-red: #a83020;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; padding: 20px 20px 100px 20px; 
            background-color: var(--bg-dark); 
            color: var(--white);
            font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;
            overflow-x: hidden;
        }

        /* èƒŒæ™¯æ°›å›´è£…é¥° */
        .bg-deco { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; }
        .bg-tri { 
            position: absolute; top: 5%; right: -50px; 
            border-left: 120px solid transparent; border-right: 120px solid transparent; border-bottom: 240px solid var(--red);
            opacity: 0.15; transform: rotate(25deg); filter: blur(20px);
        }
        .bg-circle {
            position: absolute; bottom: 15%; left: -60px; width: 200px; height: 200px;
            border: 2px solid var(--purple); border-radius: 50%; opacity: 0.1;
        }

        /* ====================
           2. å‹¾é€‰åˆ—è¡¨ UI
           ==================== */
        header { margin-bottom: 30px; }
        h1 { font-size: 26px; font-weight: 900; letter-spacing: 1px; margin: 0 0 8px 0; }
        .subtitle { color: #999; font-size: 13px; line-height: 1.5; }

        .date-divider {
            display: flex; align-items: center; color: var(--purple); 
            font-weight: 800; font-size: 20px; margin: 35px 0 15px 0;
        }
        .date-divider::after {
            content: ''; flex: 1; height: 1px; background: #333; margin-left: 15px;
        }

        /* å¡ç‰‡æ ·å¼ */
        .event-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex; align-items: center;
            transition: 0.2s;
            cursor: pointer;
        }
        
        .event-card.active {
            background: #252230;
            border-color: var(--purple);
            box-shadow: 0 4px 12px rgba(112, 101, 193, 0.2);
        }

        .chk-icon {
            width: 22px; height: 22px; border: 2px solid #555; border-radius: 4px;
            margin-right: 15px; display: flex; align-items: center; justify-content: center;
            flex-shrink: 0; background: #000;
        }
        .event-card.active .chk-icon { background: var(--purple); border-color: var(--purple); }
        .event-card.active .chk-icon::after { content: 'âœ“'; font-weight: bold; font-size: 14px; }

        .card-content { flex: 1; }
        .card-row-1 { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
        .card-time { 
            font-family: 'Courier New', monospace; font-weight: bold; font-size: 15px; /* ç¨å¾®è°ƒå°ä¸€ç‚¹é˜²æ­¢æ—¶é—´å¤ªé•¿æ¢è¡Œ */
            color: var(--purple); 
        }
        .card-loc { font-size: 12px; color: #888; background: #111; padding: 2px 6px; border-radius: 4px; }
        .card-name { font-size: 15px; color: #eee; font-weight: 500; line-height: 1.4; }
        
        .event-card.active .card-name { color: #fff; font-weight: 600; }
        .event-card.active .card-loc { color: var(--purple); background: rgba(0,0,0,0.2); }

        /* ====================
           3. åº•éƒ¨æ“ä½œæ 
           ==================== */
        .bottom-actions {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(10,10,10,0.95); backdrop-filter: blur(10px);
            padding: 15px 20px 30px 20px; border-top: 1px solid #333;
            display: flex; gap: 15px; z-index: 100;
        }
        .btn {
            flex: 1; height: 50px; border: none; border-radius: 8px;
            font-size: 14px; font-weight: bold; color: #fff; cursor: pointer;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .btn-geo { background: #222; border: 1px solid #444; }
        .btn-retro { background: var(--retro-red); box-shadow: 0 4px 10px rgba(168, 48, 32, 0.4); }
        .btn span { font-size: 10px; opacity: 0.8; font-weight: normal; margin-top: 2px; }

        /* ====================
           4. æµ·æŠ¥ç”ŸæˆåŒºåŸŸ (éšè—)
           ==================== */
        .poster-container {
            position: fixed; left: -9999px; top: 0;
            width: 375px; /* å¼ºåˆ¶æ‰‹æœºå®½åº¦ */
            z-index: -5;
        }

        /* --- é£æ ¼A: å‡ ä½• --- */
        #poster-geo {
            width: 375px; min-height: 667px; background: #050505; color: #fff;
            padding: 0; overflow: hidden; position: relative; border: 1px solid #222;
        }
        .g-header { padding: 40px 30px 20px 30px; position: relative; z-index: 2; }
        .g-title { font-size: 38px; font-weight: 900; line-height: 0.9; margin-bottom: 10px; font-family: sans-serif; }
        .g-sub { font-size: 12px; letter-spacing: 4px; color: var(--purple); font-weight: bold; }
        
        /* è£…é¥°å…ƒç´  */
        .gs-tri { 
            position: absolute; top: 20px; right: 20px; width: 0; height: 0;
            border-left: 50px solid transparent; border-right: 50px solid transparent; border-bottom: 100px solid #333;
            transform: rotate(15deg);
        }
        .gs-circle-purp {
            position: absolute; top: 100px; right: -20px; width: 80px; height: 80px; 
            border: 10px solid var(--purple); border-radius: 50%; opacity: 0.8;
        }
        .gs-circle-red {
            position: absolute; bottom: 100px; right: -30px; width: 120px; height: 120px;
            border: 15px solid var(--red); border-radius: 50%; opacity: 0.6; z-index: 0;
        }

        .g-list { padding: 0 30px 60px 30px; position: relative; z-index: 1; }
        .g-day-row { margin-top: 25px; }
        .g-day-title { 
            font-size: 20px; font-weight: 800; color: #fff; background: #000; 
            display: inline-block; padding-right: 15px; border-bottom: 2px solid var(--purple); margin-bottom: 10px;
        }
        .g-item { 
            display: flex; align-items: baseline; margin-bottom: 8px; 
            border-left: 1px solid #333; padding-left: 10px; margin-left: 5px;
        }
        .g-time { width: 90px; flex-shrink: 0; color: #888; font-family: monospace; font-weight: bold; font-size: 14px; }
        .g-info { flex: 1; }
        .g-name { font-size: 14px; font-weight: 500; line-height: 1.3; }
        /* ã€ä¿®å¤ã€‘å‡ ä½•é£åœ°ç‚¹æ–‡å­—é¢œè‰²ï¼šå˜æµ… */
        .g-loc { font-size: 10px; color: #aaa; margin-top: 3px; display: block; }

        /* --- é£æ ¼B: å¤å¤ --- */
        #poster-retro {
            width: 375px; min-height: 667px;
            background-color: var(--retro-bg);
            color: var(--retro-ink);
            padding: 20px;
            font-family: "Songti SC", "SimSun", serif; /* å®‹ä½“ */
            position: relative;
            background-image: linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .r-frame {
            border: 4px double var(--retro-ink);
            height: 100%;
            padding: 15px;
            position: relative;
            background: rgba(255,255,255,0.4);
        }
        .r-corner {
            position: absolute; width: 20px; height: 20px; border: 2px solid var(--retro-ink);
        }
        .rc-tl { top: 5px; left: 5px; border-right: none; border-bottom: none; }
        .rc-tr { top: 5px; right: 5px; border-left: none; border-bottom: none; }
        .rc-bl { bottom: 5px; left: 5px; border-right: none; border-top: none; }
        .rc-br { bottom: 5px; right: 5px; border-left: none; border-top: none; }

        .r-header { text-align: center; border-bottom: 2px solid var(--retro-ink); padding-bottom: 15px; margin-bottom: 20px; }
        /* ã€ä¿®å¤ã€‘å¤å¤é£æ ‡é¢˜ï¼šå­—å·ç¼©å°ä»¥å®¹çº³æ›´é•¿æ ‡é¢˜ */
        .r-title { font-size: 24px; font-weight: bold; letter-spacing: 2px; color: var(--retro-red); margin-bottom: 5px; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
        .r-sub { font-size: 12px; text-transform: uppercase; letter-spacing: 2px; font-family: sans-serif; color: #555; }

        /* ã€ä¿®å¤ã€‘å¤å¤å°ç« ï¼šä½ç½®å¾®è°ƒï¼Œé˜²æ­¢é®æŒ¡æ–‡å­— */
        .r-stamp {
            position: absolute; top: 15px; right: 15px;
            width: 80px; height: 80px; border: 3px solid var(--retro-red); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; flex-direction: column;
            color: var(--retro-red); transform: rotate(-15deg); opacity: 0.7; /* å¢åŠ é€æ˜åº¦ */
            z-index: 10; 
            /* å»æ‰èƒŒæ™¯è‰²ï¼Œåšæˆé€å æ•ˆæœæ›´åƒå°ç«  */
            background: transparent;
            box-shadow: inset 0 0 0 2px rgba(168, 48, 32, 0.1); 
        }
        .r-stamp span { font-weight: bold; font-size: 14px; line-height: 1.2; }
        
        .r-list { padding: 0 5px; }
        .r-day-block { margin-bottom: 20px; }
        .r-day-head { 
            background: var(--retro-ink); color: var(--retro-bg); 
            display: inline-block; padding: 2px 10px; font-weight: bold; margin-bottom: 8px;
            font-family: sans-serif; font-size: 14px;
        }
        
        .r-item { 
            display: flex; border-bottom: 1px dashed #aaa; padding: 6px 0; align-items: flex-end; 
        }
        .r-time { 
            font-family: "Courier New", monospace; font-weight: bold; font-size: 15px; 
            color: var(--retro-red); width: 95px; flex-shrink: 0;
        }
        .r-content { flex: 1; }
        .r-name { font-size: 15px; font-weight: bold; color: #111; line-height: 1.3; }
        .r-loc { font-size: 11px; color: #666; font-style: italic; }

        .r-footer {
            margin-top: 30px; text-align: center; font-size: 10px; color: #666;
            border-top: 1px solid #ccc; padding-top: 10px; font-family: sans-serif;
        }

        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 200; flex-direction: column; align-items: center; justify-content: center;
        }
        .modal img { max-width: 90%; max-height: 80vh; border: 1px solid #333; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 20px; right: 20px; color: #fff; font-size: 30px; cursor: pointer; }
        .modal-tip { color: #fff; margin-top: 15px; font-size: 14px; }

    </style>
</head>
<body>

<div class="bg-deco">
    <div class="bg-tri"></div>
    <div class="bg-circle"></div>
</div>

<div class="container">
    <header>
        <h1>ISLAND THEATRE</h1>
        <div class="subtitle">2025 å²›å±¿é’å¹´æˆå‰§èŠ‚ Â· è¡Œç¨‹å›¾ç”Ÿæˆå°åŠ©æ‰‹</div>
    </header>

    <div id="selection-list"></div>
</div>

<div class="bottom-actions">
    <button class="btn btn-geo" onclick="generatePoster('geo')">
        å‡ ä½•é£æ ¼
        <span>Geometric</span>
    </button>
    <button class="btn btn-retro" onclick="generatePoster('retro')">
        å¤å¤æˆç¥¨
        <span>Vintage</span>
    </button>
</div>

<div class="poster-container">
    
    <div id="poster-geo">
        <div class="gs-tri"></div>
        <div class="gs-circle-purp"></div>
        <div class="gs-circle-red"></div>
        <div class="g-header">
            <div class="g-title">MY<br>ISLAND<br>JOURNEY</div>
            <div class="g-sub">YOUTH THEATRE FESTIVAL 2025</div>
        </div>
        <div class="g-list" id="geo-content"></div>
    </div>

    <div id="poster-retro">
        <div class="r-frame">
            <div class="r-corner rc-tl"></div><div class="r-corner rc-tr"></div>
            <div class="r-corner rc-bl"></div><div class="r-corner rc-br"></div>
            
            <div class="r-stamp">
                <span>é¼“æµªå±¿<br>å£¹å·</span>
            </div>

            <div class="r-header">
                <div class="r-title">å³¶å¶¼é’å¹´æˆ²åŠ‡ç¯€è¡Œç¨‹å–®</div>
                <div class="r-sub">Island Youth Theatre Festival</div>
            </div>

            <div class="r-list" id="retro-content"></div>

            <div class="r-footer">
                <div>KULANGSU ART PARK Â· XIAMEN</div>
                <div style="transform: scale(0.8); margin-top:5px;">NO. 2025-12-2430</div>
            </div>
        </div>
    </div>

</div>

<div class="modal" id="resultModal">
    <div class="modal-close" onclick="document.getElementById('resultModal').style.display='none'">Ã—</div>
    <img id="final-image" />
    <p class="modal-tip">é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ</p>
</div>

<script>
    // 1. å…¨é‡æ•°æ®å½•å…¥
    const scheduleData = [
        {
            date: "12æœˆ24æ—¥",
            events: [
                { time: "15:00", dur: 60, loc: "é¹­æ½®å…", name: "å­¦é™¢è§‚å¯Ÿï¼šåŸºäºä¸¤å²¸è§†è§’çš„æ ¡å›­æˆå‰§" },
                { time: "16:00", dur: 45, loc: "é¹­æ½®å…", name: "åˆ›æŠ•è®¡åˆ’ã€é³—é²¡è®¡åˆ’å…¥é€‰ä½œå“ä»‹ç»" },
                { time: "17:00", dur: 60, loc: "é¹­æ½®å…", name: "ä»Šå¹´æˆå‰§å¸‚åœºå˜å¥½äº†å—ï¼Ÿ" },
                { time: "19:00", dur: 100, loc: "å…ˆé”‹å‰§åœº", name: "ç¬¬äºŒæ€§" },
                { time: "20:00", dur: 30, loc: "é¼“æµªå±¿ç¾é™¢å›­åŒºæˆ·å¤–", name: "è¿½æ¢¦é©¬è½¦ï¼šåœ£è¯æˆå‰§ä¹‹å¤œå¤§å·¡æ¸¸" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šæ·¡æ°´ã€‹å‰§æœ¬å›´è¯»" }
            ]
        },
        {
            date: "12æœˆ25æ—¥",
            events: [
                { time: "10:00", dur: 180, loc: "KCCAä¸»å±•å…å‰¯å…", name: "æˆå‰§ç–—æ„ˆÂ·æ¢¦å¢ƒå·¥ä½œåŠ" },
                { time: "12:00", dur: 70, loc: "é¹­æ½®å…Â·å¤©å°", name: "åšä¸€ä¸ªåƒé¥­ç‰ˆå‰§çš„é’å¹´æˆå‰§äººÂ·é’å¹´æˆå‰§å¯¹è°ˆ" },
                { time: "14:30", dur: 90, loc: "KCCAä¸»å±•å…", name: "åƒè‡ªç„¶ä¸€æ ·ç”Ÿé•¿Â·è‚¢ä½“å·¥ä½œåŠ" },
                { time: "15:30", dur: 100, loc: "å…ˆé”‹å‰§åœº", name: "ç¬¬äºŒæ€§" },
                { time: "15:00", dur: 60, loc: "é¹­æ½®å…Â·å¤©å°", name: "ç“¦æ—¥è¿ªÂ·ç©†ç“¦å¾·ã€Šæµ·é¸¥ã€‹å—å¤§å‡ºç‰ˆç¤¾æ–‡æœ¬åˆ†äº«" },
                { time: "17:00", dur: 60, loc: "å²›å²¸ä¹¦åº—", name: "è’æ¼ é‡Œå¼€å‡ºç‹¬ç«‹çš„èŠ±ï¼šç‹¬ç«‹å‰§å›¢å¯¹è°ˆ" },
                { time: "19:30", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "é‚£å¤©é¼ å§‘å“­å¾—å¾ˆä¼¤å¿ƒ" },
                { time: "19:30", dur: 90, loc: "KCCAä¸»å±•å…", name: "ç¤¼ç‰©ï¼šå³å…´äº’åŠ¨å·¥ä½œåŠ" },
                { time: "20:00", dur: 60, loc: "å²›å²¸ä¹¦åº—", name: "ã€Šæˆ‘çš„è‰ºæœ¯ç”Ÿæ´»ã€‹ï¼šä¸Šæµ·è¯‘æ–‡æ–¯å¦å°¼ä¼ è®°æ–‡æœ¬åˆ†äº«" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šæµ·é¸¥ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:30", dur: 60, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "é³—é²¡è®¡åˆ’å¼€æ”¾å‰§æœ¬å›´è¯»" }
            ]
        },
        {
            date: "12æœˆ26æ—¥",
            events: [
                { time: "10:00", dur: 45, loc: "å­¦æœ¯å…2æ¥¼", name: "å¸ƒè¢‹æœ¨å¶æˆæ“å¶å·¥ä½œåŠ" },
                { time: "11:00", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "é‚£å¤©é¼ å§‘å“­å¾—å¾ˆä¼¤å¿ƒ" },
                { time: "13:00", dur: 60, loc: "KCCAä¸»å±•å…", name: "é™„å­" },
                { time: "13:00", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "å‰§ç›’PlayBOX ç´ æå–œå‰§" },
                { time: "14:00", dur: 60, loc: "æµ·è¾¹å¤©å°", name: "å¯¹è¯ç”°çº³è¥¿Â·å¨å»‰æ–¯ï¼šä¸Šæµ·è¯‘æ–‡å‡ºç‰ˆç¤¾&å—å¤§å‡ºç‰ˆç¤¾" },
                { time: "15:30", dur: 60, loc: "é¹­æ½®å…", name: "ã€Šç¬¬äºŒæ€§ã€‹ä¸»åˆ›åˆ†äº«ï¼šå…³äºå¥³æ€§çš„æˆå‰§åˆ›ä½œè°ˆ" },
                { time: "16:00", dur: 60, loc: "KCCAä¸»å±•å…", name: "æˆå‰§è¡¨æ¼”å·¥ä½œåŠ" },
                { time: "16:30", dur: 60, loc: "å²›å²¸ä¹¦åº—", name: "æ–‡æœ¬ä¸æƒ…æ„Ÿï¼šé¼ å§‘ä¸»åˆ›åˆ†äº«" },
                { time: "16:30", dur: 90, loc: "å…ˆé”‹å‰§åœº", name: "æˆ‘ä»¬çš„èµµå­¤" },
                { time: "17:30", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "æˆ‘æ˜¯é£ï¼šå‰§æœ¬å›´è¯»å¼æ¼”å‡º" },
                { time: "19:30", dur: 60, loc: "é¹­æ½®å…", name: "è§†è§’ä¸ä¸–ç•Œï¼šå¥³æ€§åˆ›ä½œè€…å¯¹è°ˆ" },
                { time: "20:30", dur: 75, loc: "å…ˆé”‹å‰§åœº", name: "ç«¹æ—é™¢" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šæœå¦–ä¹‹é‰´ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:30", dur: 60, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "é³—é²¡è®¡åˆ’å¼€æ”¾å‰§æœ¬å›´è¯»" }
            ]
        },
        {
            date: "12æœˆ27æ—¥",
            events: [
                { time: "09:30", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "ç¥å¥‡é£ä¹¦ç»˜æœ¬å‰§" },
                { time: "10:00", dur: 60, loc: "å­¦æœ¯å…2æ¥¼", name: "ç¿»è¯‘çš„æ–‡æœ¬ç»ƒä¹ " },
                { time: "10:30", dur: 360, loc: "KCCAä¸»å±•å…å‰¯å…", name: "å³å…´å¿ƒæ³•è¯¾" },
                { time: "11:00", dur: 30, loc: "å…ˆé”‹å‰§åœºÂ·Liveèˆå°", name: "æŠ˜å­æˆï¼šæ­Œä»”ä¸é«˜ç”²" },
                { time: "11:30", dur: 45, loc: "å…ˆé”‹å‰§åœºÂ·Liveèˆå°", name: "å¸ƒè¢‹æœ¨å¶æˆ" },
                { time: "13:00", dur: 75, loc: "å…ˆé”‹å‰§åœº", name: "ç«¹æ—é™¢" },
                { time: "13:30", dur: 110, loc: "KCCAä¸»å±•å…", name: "ä¸ä¼šè®²æ•…äº‹çš„å¤šæ¯”" },
                { time: "14:00", dur: 60, loc: "å­¦æœ¯å…2æ¥¼", name: "å¤®åæˆå‰§çš„ä¸“ä¸šç†å¿µ" },
                { time: "14:30", dur: 15, loc: "æµ·è¾¹å¤©å°", name: "å£³Shellè‚¢ä½“å‰§" },
                { time: "15:15", dur: 15, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "æ¥ç–¯å–œå‰§å¿«é—ª" },
                { time: "15:00", dur: 60, loc: "é¹­æ½®å…", name: "æ‰˜å°”æ–¯æ³°æˆå‰§é›†" },
                { time: "15:30", dur: 60, loc: "å­¦æœ¯å…2æ¥¼", name: "èŠ¥å·çš„ä¸­å›½è°ˆ" },
                { time: "15:45", dur: 15, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "æ¥ç–¯å–œå‰§å¿«é—ª" },
                { time: "16:00", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "é‚£å¤©é¼ å§‘å“­å¾—å¾ˆä¼¤å¿ƒ" },
                { time: "16:30", dur: 60, loc: "å²›å²¸ä¹¦åº—", name: "åç°ä»£æ¼”å‡ºå‰§åœºï¼šå¯¹è¯å‰§åœº" },
                { time: "17:30", dur: 60, loc: "KCCAä¸»å±•å…", name: "é“ƒæœ¨è¡¨æ¼”æ³•" },
                { time: "19:00", dur: 60, loc: "å­¦æœ¯å…2æ¥¼", name: "ä¸€ä½æˆå‰§è§‚å¯Ÿè€…çœ‹åˆ°çš„æ—¶ä»£æˆå‰§æ–°ç”Ÿå‘½" },
                { time: "19:00", dur: 60, loc: "é¹­æ½®å…", name: "èµµå­¤ï¼Œæ–‡å­¦å‰§åœºæ¼«è°ˆ" },
                { time: "19:00", dur: 150, loc: "å…ˆé”‹å‰§åœº", name: "ä¸‡æ™“åˆ©LIVE" },
                { time: "20:30", dur: 60, loc: "KCCAä¸»å±•å…", name: "è‹±æ–‡å³å…´æˆå‰§å·¥åŠ" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šå¡é‡Œå¤æ‹‰ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:30", dur: 60, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "é³—é²¡è®¡åˆ’å¼€æ”¾å‰§æœ¬å›´è¯»" },
                { time: "22:00", dur: 90, loc: "å…ˆé”‹å‰§åœº", name: "ä¸‰å§å¦¹" }
            ]
        },
        {
            date: "12æœˆ28æ—¥",
            events: [
                { time: "09:30", dur: 60, loc: "å…ˆé”‹å‰§åœº", name: "ä¸ä¸å°å¯¼ç»˜æœ¬å‰§" },
                { time: "10:00", dur: 60, loc: "å­¦æœ¯å…2æ¥¼", name: "éŸ³ä¹å‰§å·¥ä½œåŠ" },
                { time: "10:30", dur: 360, loc: "KCCAä¸»å±•å…å‰¯å…", name: "å³å…´å¿ƒæ³•è¯¾" },
                { time: "11:00", dur: 90, loc: "å…ˆé”‹å‰§åœº", name: "ä¸‰å§å¦¹" },
                { time: "13:00", dur: 75, loc: "KCCAä¸»å±•å…å‰¯å…", name: "æ¢¦å¢ƒå¥‡é‡è‚¢ä½“å‰§" },
                { time: "13:30", dur: 45, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "å¸ƒè¢‹æœ¨å¶æˆ" },
                { time: "14:00", dur: 30, loc: "å…ˆé”‹å‰§åœº", name: "é™„å­" },
                { time: "14:30", dur: 90, loc: "é¹­æ½®å…", name: "éŸ³ä¹å‰§ã€Šå®ç‰ã€‹ç»ƒä¹ å£°" },
                { time: "15:30", dur: 60, loc: "å²›å²¸ä¹¦åº—", name: "å¥‘è¯ƒå¤«çš„ä¸€ç”Ÿï¼šä¸Šæµ·è¯‘æ–‡å‡ºç‰ˆç¤¾æ–‡æœ¬åˆ†äº«" },
                { time: "16:00", dur: 80, loc: "å…ˆé”‹å‰§åœº", name: "ä¸å±±å·¨æºä¹¦" },
                { time: "16:00", dur: 60, loc: "é¹­æ½®å…Â·å¤©å°", name: "æ–‡æœ¬ä¸ç°å®ä¸»ä¹‰ï¼šå¯¹è¯ç¼–å‰§" },
                { time: "16:30", dur: 60, loc: "é¹­æ½®å…", name: "é’å¹´ä¸ä¼ ç»Ÿ" },
                { time: "17:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "æ°‘è¥å‰§å›¢å®å½•" },
                { time: "19:30", dur: 90, loc: "å…ˆé”‹å‰§åœº", name: "é—½å—å­¦é™¢è§‚å¯Ÿï¼šæ—¶é—´çš„é‡é‡å››è”å‰§" },
                { time: "20:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šæˆ‘å¼¥ç•™ä¹‹é™…ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šé“çš®å±‹é¡¶ä¸Šçš„çŒ«ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:30", dur: 60, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "é³—é²¡è®¡åˆ’å¼€æ”¾å‰§æœ¬å›´è¯»" }
            ]
        },
        {
            date: "12æœˆ29æ—¥",
            events: [
                { time: "10:00", dur: 60, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å±•æ¼” A, Bç»„" },
                { time: "11:00", dur: 110, loc: "å…ˆé”‹å‰§åœº", name: "ä¸ä¼šè®²æ•…äº‹çš„å¤šæ¯”" },
                { time: "12:00", dur: 60, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å±•æ¼” C, Dç»„" },
                { time: "14:00", dur: 60, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å±•æ¼” E, Fç»„" },
                { time: "15:30", dur: 75, loc: "å…ˆé”‹å‰§åœº", name: "é¦–é˜³å±±çš„æœ€åä¸€æ—¥" },
                { time: "16:00", dur: 60, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å±•æ¼” G, Hç»„" },
                { time: "19:30", dur: 80, loc: "å…ˆé”‹å‰§åœº", name: "ä¸å±±å·¨æºä¹¦" },
                { time: "21:00", dur: 60, loc: "KCCAÂ·çŸ³åº­", name: "ã€Šç”Ÿä¹‹ä»£ä»·ã€‹å‰§æœ¬å›´è¯»" },
                { time: "21:30", dur: 60, loc: "ç‰¡è›æˆå‰§å¸‚é›†", name: "é³—é²¡è®¡åˆ’å¼€æ”¾å‰§æœ¬å›´è¯»" }
            ]
        },
        {
            date: "12æœˆ30æ—¥",
            events: [
                { time: "10:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "11:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "12:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "13:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "14:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "15:30", dur: 75, loc: "å…ˆé”‹å‰§åœº", name: "é¦–é˜³å±±çš„æœ€åä¸€æ—¥" },
                { time: "16:00", dur: 30, loc: "é¹­æ½®å…", name: "åˆ›æŠ•å¯¹è°ˆ" },
                { time: "19:30", dur: 75, loc: "å…ˆé”‹å‰§åœº", name: "åˆ›æŠ•è®¡åˆ’é¢å¥–" }
            ]
        }
    ];

    // è®¡ç®—ç»“æŸæ—¶é—´ (HH:mm - HH:mm)
    function getRange(start, min) {
        let [h, m] = start.split(':').map(Number);
        let d = new Date(); d.setHours(h, m, 0);
        
        let startStr = `${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;
        
        d.setMinutes(d.getMinutes() + min);
        let endStr = `${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;
        
        return `${startStr}-${endStr}`;
    }

    // 2. æ¸²æŸ“å‹¾é€‰åˆ—è¡¨
    const listDiv = document.getElementById('selection-list');
    scheduleData.forEach(day => {
        let dayDiv = document.createElement('div');
        dayDiv.innerHTML = `<div class="date-divider">${day.date}</div>`;
        
        day.events.forEach(evt => {
            let card = document.createElement('div');
            card.className = 'event-card';
            
            // æ•°æ®å±æ€§
            let range = getRange(evt.time, evt.dur);
            card.dataset.json = JSON.stringify({
                day: day.date,
                range: range,
                name: evt.name,
                loc: evt.loc,
                sortTime: evt.time
            });

            card.onclick = function() {
                this.classList.toggle('active');
            };

            // ã€ä¿®å¤ã€‘å‹¾é€‰åˆ—è¡¨ä¸­æ˜¾ç¤ºæ—¶é—´æ®µï¼Œè€Œä¸ä»…ä»…æ˜¯å¼€å§‹æ—¶é—´
            card.innerHTML = `
                <div class="chk-icon"></div>
                <div class="card-content">
                    <div class="card-row-1">
                        <span class="card-time">${range}</span>
                        <span class="card-loc">ğŸ“${evt.loc}</span>
                    </div>
                    <div class="card-name">${evt.name}</div>
                </div>
            `;
            dayDiv.appendChild(card);
        });
        listDiv.appendChild(dayDiv);
    });

    // 3. ç”Ÿæˆé€»è¾‘
    function generatePoster(style) {
        const actives = document.querySelectorAll('.event-card.active');
        if(actives.length === 0) return alert('è¯·å…ˆé€‰æ‹©è‡³å°‘ä¸€ä¸ªæ´»åŠ¨ï¼');

        // æ•°æ®å½’ç±»
        let data = {};
        actives.forEach(el => {
            let item = JSON.parse(el.dataset.json);
            if(!data[item.day]) data[item.day] = [];
            data[item.day].push(item);
        });

        // æ¸²æŸ“æµ·æŠ¥DOM
        if(style === 'geo') renderGeo(data);
        else renderRetro(data);

        // æˆªå›¾
        const targetId = style === 'geo' ? 'poster-geo' : 'poster-retro';
        const element = document.getElementById(targetId);
        
        // å…³é”®ä¿®å¤ï¼šhtml2canvas å‚æ•°è®¾ç½®ï¼Œé˜²æ­¢å³ä¾§åˆ‡è¾¹
        html2canvas(element, {
            scale: 2, // é«˜æ¸…
            useCORS: true,
            width: 375, // å¼ºåˆ¶å®½åº¦
            windowWidth: 375, // æ¨¡æ‹Ÿçª—å£å®½åº¦
            onclone: (clonedDoc) => {
                // ç¡®ä¿å…‹éš†å‡ºæ¥çš„å…ƒç´ æ˜¯å¯è§çš„
                const clonedEl = clonedDoc.getElementById(targetId);
                clonedEl.style.display = 'block';
            }
        }).then(canvas => {
            const img = document.getElementById('final-image');
            img.src = canvas.toDataURL('image/png');
            document.getElementById('resultModal').style.display = 'flex';
        });
    }

    function renderGeo(data) {
        const con = document.getElementById('geo-content');
        con.innerHTML = '';
        for(let d in data) {
            data[d].sort((a,b) => a.sortTime.localeCompare(b.sortTime));
            let html = `<div class="g-day-row"><div class="g-day-title">${d}</div>`;
            data[d].forEach(ev => {
                html += `
                    <div class="g-item">
                        <div class="g-time">${ev.range}</div>
                        <div class="g-info">
                            <div class="g-name">${ev.name}</div>
                            <span class="g-loc">@${ev.loc}</span>
                        </div>
                    </div>`;
            });
            html += `</div>`;
            con.innerHTML += html;
        }
    }

    function renderRetro(data) {
        const con = document.getElementById('retro-content');
        con.innerHTML = '';
        for(let d in data) {
            data[d].sort((a,b) => a.sortTime.localeCompare(b.sortTime));
            let html = `<div class="r-day-block"><div class="r-day-head">${d}</div>`;
            data[d].forEach(ev => {
                html += `
                    <div class="r-item">
                        <div class="r-time">${ev.range}</div>
                        <div class="r-content">
                            <div class="r-name">${ev.name}</div>
                            <div class="r-loc">${ev.loc}</div>
                        </div>
                    </div>`;
            });
            html += `</div>`;
            con.innerHTML += html;
        }
    }
</script>
</body>
</html>